<!DOCTYPE html>
<html>
<title>Malware Visualization</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!--<script src="../lib/d3.v5.min.js"></script>-->
<script src="https://d3js.org/d3.v4.js"></script>
<script src="https://d3js.org/d3-color.v1.min.js"></script>
<script src="https://d3js.org/d3-interpolate.v1.min.js"></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
<script src="https://d3js.org/d3-scale.v3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="https://cdn.jsdelivr.net/npm/lodash@4.17.4/lodash.min.js"></script>
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel='stylesheet' href='https://use.fontawesome.com/releases/v5.7.0/css/all.css' integrity='sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ' crossorigin='anonymous'>

<link rel="stylesheet" href="../styles/v3main.css">
<link rel="stylesheet" href="../styles/v3sidebar.css">
<style>
    body,h1,h2,h3,h4,h5,h6 {font-family: "Raleway", sans-serif}
</style>
<body class="w3-light-grey">

<!-- Overlay effect when opening sidebar on small screens -->
<div class="w3-overlay w3-hide-large w3-animate-opacity" onclick="w3_close()" style="cursor:pointer" title="close side menu" id="myOverlay"></div>

<!-- Rank navigation sidebar-->
<div id="mySidenavRank" class="sidenav">
    <a href="javascript:void(0)" class="closebtn" onclick="closeNavRank()">&times;</a>
    <!-- Second Photo Grid-->
    <div class="w3-row-padding" style="margin-bottom:30px">
        <h4 class="w3-container" id="rankedbydeg" style="position: absolute; padding-left: 20px"><b>Processes ranked by
            degree</b></h4>
        <div class="w3-twothird w3-container w3-margin-bottom">

            <div class="w3-container w3-white" style="padding-right: 0">
                <div id="ranked" class="contentRanked">

                </div>
            </div>
        </div>
        <div class="w3-third w3-container w3-margin-bottom">

            <div class="w3-container w3-white" >
                <p><b>Types of References / Underlay Reference Stream</b></p>
                <div class="w3-container w3-white" style="padding-right: 0">
                    <div id="legend"></div>
                </div>
            </div>
        </div>

        <div class="w3-third w3-container w3-margin-bottom">

            <div class="w3-container w3-white" style="padding-right: 0">
                <p><b>Self-call processes</b></p>

                <div id="selfCallProcess" class="contentSelf"></div>

            </div>
        </div>


        <div class="w3-third w3-container">
            <div class="w3-container w3-white" style="padding-right: 0">
                <p><b>Connecting domains:</b></p>
                <div id="maliciousdomain" class="contentSelf2"></div>
            </div>
        </div>
    </div>
</div>
<!-- Rank navigation sidebar-->
<div id="mySidenavLib" class="sidenav">
    <a href="javascript:void(0)" class="closebtn" onclick="closeNavLib()">&times;</a>
    <!-- Lib Section -->
    <div class="w3-container w3-padding-large w3-white">
        <h4 id="library"><b>Libraries Called</b></h4>

        <table width="100%" border="0px">
            <tbody>
            <tr>
                <td width="100%">
                    <div>
                        <p>
                            <label for="amount">Number of libraries called:</label>
                            <input type="text" id="amount" readonly style="border:0; color:#f6931f; font-weight:bold;">
                        </p>
                        <div id="slider"
                             style="width: 400px; background: linear-gradient(to right, #ffffff 0%, #000000 100%);">
                            <div id="custom-handle" class="ui-slider-handle" style="z-index: auto"></div>
                        </div>
                        <span>
                            <p>Order: <select id="order">
                                <option value="similarity">By Similarity</option>
                                <option value="name">By Name</option>
                                <option value="frequency">By Frequency</option>
                                <option value="linkDiff">By Different libraries called</option>
                            </select>
                            </p>
                        </span>
                    </div>

                </td>
            </tr>
            </tbody>
        </table>
        <div id="matrix2D"></div>

        <div class="tooltip" style="opacity: 0;" id="ttMatrix"></div>
    </div>
</div>

<!-- !PAGE CONTENT! -->
<div class="w3-main" style="margin-left:0px" id="mainContent">

    <!-- Header -->
    <header id="portfolio">
        <span class="w3-button w3-hide-large w3-xxlarge w3-hover-text-grey" onclick="w3_open()"><i class="fa fa-bars"></i></span>
        <div class="w3-container">
            <h1><b>Malware Visualization</b></h1>
            <div class="w3-section w3-bottombar w3-padding-16">
                <!--<span class="w3-margin-right">Filter:</span>-->
                <button class="w3-button w3-black" id="processBtn">Processes</button>
                <button class="w3-button w3-white" onclick="openNavRank()" id="rankBtn">Ranked by Degree</button>
                <button class="w3-button w3-white w3-hide-small" onclick="openNavLib()" id="libBtn">Libraries
                    Called</button>

                <label for="selectmalware">Select dataset: </label>
                <select id="selectmalware" class="selectmalware">
                    <option>--Select dataset--</option>

                    <option value="Moi-Win7-RemoteAccess_1.CSV">Moi-Win7-RemoteAccess_1</option>
                    <option value="Moi-Win7-RemoteAccess_2.CSV">Moi-Win7-RemoteAccess_2</option>
                    <option value="Moi-Win7-RemoteAccess_3.CSV">Moi-Win7-RemoteAccess_3</option>
                    <option value="Moi-Win7-RemoteAccess_4.CSV">Moi-Win7-RemoteAccess_4</option>
                    <option value="Moi-Win7-RemoteAccess_5.CSV">Moi-Win7-RemoteAccess_5</option>
                    <option value="Moi-Win7-RemoteAccess_6.CSV">Moi-Win7-RemoteAccess_6</option>
                    <option value="Moi-Win7-RemoteAccess_7.CSV">Moi-Win7-RemoteAccess_7</option>
                    <option value="Moi-XP-RemoteAccess_1.CSV">Moi-XP-RemoteAccess_1</option>
                    <option value="Moi-XP-RemoteAccess_2.CSV">Moi-XP-RemoteAccess_2</option>
                    <option value="Moi-XP-RemoteAccess_3.CSV">Moi-XP-RemoteAccess_3</option>
                    <option value="Moi-XP-RemoteAccess_4.CSV">Moi-XP-RemoteAccess_4</option>
                    <option value="Moi-XP-RemoteAccess_5.CSV">Moi-XP-RemoteAccess_5</option>
                    <option value="Moi-XP-RemoteAccess_6.CSV">Moi-XP-RemoteAccess_6</option>
                    <option value="Moi-XP-RemoteAccess_7_exec.CSV">Moi-XP-RemoteAccess_7_exec</option>
                    <option value="Moi-XP-RemoteAccess_7_install.CSV">Moi-XP-RemoteAccess_7_install</option>

                    <option value="faran-7-vs-backdoor-9.CSV">faran-7-vs-backdoor-9</option>
                    <option value="faran-7-vs-backdoor-10.CSV">faran-7-vs-backdoor-10</option>
                    <option value="faran-7-vs-backdoor-11.CSV">faran-7-vs-backdoor-11</option>
                    <option value="faran-7-vs-backdoor-12.CSV">faran-7-vs-backdoor-12</option>
                    <option value="faran-7-vs-backdoor-13.CSV">faran-7-vs-backdoor-13</option>
                    <option value="faran-7-vs-backdoor-14.CSV">faran-7-vs-backdoor-14</option>
                    <option value="faran-7-vs-backdoor-15.CSV">faran-7-vs-backdoor-15</option>
                    <option value="Faran-win7-vs-7fa0ef3f22045c45c80885865d0d0942.CSV">Faran-win7-vs-7fa0ef3f22045c45c80885865d0d0942</option>
                    <option value="Faran-win7-vs-13ef35e912a54739a27015eecc3fbbaeaf2ba2b7a2a49bfd11e26e099a330926.CSV">Faran-win7-vs-13ef35e912a54739a27015eecc3fbbaeaf2ba2b7a2a49bfd11e26e099a330926</option>
                    <option value="Vung-Win7-Bladabindi.CSV">Vung-Win7-Bladabindi</option>
                    <option value="Vung-Win7-Cryptowall.CSV">Vung-Win7-Cryptowall</option>
                    <option value="Vung-Win7-Locky.Gen.CSV">Vung-Win7-Locky.Gen</option>
                    <option value="Vung-Win7-Multinjector.CSV">Vung-Win7-Multinjector</option>
                    <option value="Vung-Win7-Teerac.B.CSV">Vung-Win7-Teerac.B</option>
                    <option value="VungPham-Behavior-Bladabindi.gen-XP.CSV">VungPham-Behavior-Bladabindi.gen-XP</option>
                    <option value="VungPham-Behavior-MultiInjector-XP.CSV">VungPham-Behavior-MultiInjector-XP</option>
                    <option value="VungPham-Behavior-Vawtrak.A-XP.CSV">VungPham-Behavior-Vawtrak.A-XP</option>
                    <option value="VungPham-Behavior-Winwebsec.I.CSV">VungPham-Behavior-Winwebsec.I</option>
                    <option value="Vung-Behavior-XP-Payment copy.CSV">Vung-Behavior-XP-Payment copy</option>
                    <option value="Vung-Behavior-XP-RemR.CSV">Vung-Behavior-XP-RemR</option>
                    <option value="Vung-Behavior-XP-Scan copy (alloyanycut).CSV">Vung-Behavior-XP-Scan-copy-(alloyanycut)</option>


                    <option> - - - - - - - Filtered log files - - - - - - - </option>

                    <option value="Faran-Trojan-Backdoor.win32.BlueIce.CSV">Faran-Trojan-Backdoor.win32.BlueIce</option>
                    <option value="Faran-Trojan-Backdoor.Win32.CyberSpy.13.b.CSV">Faran-Trojan-Backdoor.Win32.CyberSpy.13.b</option>
                    <option value="Faran-Trojan-Backdoor.win32.Death.25.i.CSV">Faran-Trojan-Backdoor.win32.Death.25.i</option>
                    <option value="Faran-Trojan-Backdoor.win32.executor.a.CSV">Faran-Trojan-Backdoor.win32.executor.a</option>
                    <option value="Faran-win7-Trojan-Backdoor.Win32.Alicia.o.CSV">Faran-win7-Trojan-Backdoor.Win32.Alicia.o</option>
                    <option value="Faran-win7-Trojan-Backdoor.win32.Executor.a.CSV">Faran-win7-Trojan-Backdoor.win32.Executor.a</option>

                    <option value="Huyen-Ransomware-WannaPeace.csv">Huyen-Ransomware-WannaPeace</option>
                    <option value="Huyen-Trojan-Infostealer.Dexter.csv">Huyen-Trojan-Infostealer.Dexter</option>

                    <option value="Vung-Email-Flooder-Absolut-XP.CSV">Vung-Email-Flooder-Absolut-XP</option>
                    <option value="Vung-Email-Flooder-Achis-Win10.CSV">Vung-Email-Flooder-Achis-Win10</option>
                    <option value="Vung-Email-Flooder-Achis-XP.CSV">Vung-Email-Flooder-Achis-XP</option>
                    <option value="Vung-Email-Flooder-Archis-Win7.CSV">Vung-Email-Flooder-Archis-Win7</option>
                    <option value="Vung-HackTool-BackSteal-Win10.CSV">Vung-HackTool-BackSteal-Win10</option>
                    <option value="Vung-HackTool-EmailCrack1-Win10.CSV">Vung-HackTool-EmailCrack1-Win10</option>
                    <option value="Vung-HackTool-EmailCrack-Win10.CSV">Vung-HackTool-EmailCrack-Win10</option>
                    <option value="Vung-HackTool-EmailCrack-XP.CSV">Vung-HackTool-EmailCrack-XP</option>
                    <option value="Vung-HackTool-Stealm1-Win10.CSV">Vung-HackTool-Stealm1-Win10</option>
                    <option value="Vung-HackTool-Stealm-Win10.CSV">Vung-HackTool-Stealm-Win10</option>


                </select>

            </div>
        </div>
    </header>

    <!-- First Photo Grid-->

    <div class="w3-row-padding" style="background-color:#cecece; margin-bottom: 20px">
        <h4 class="w3-container"><b>Processes</b></h4>
        <div class="w3-threequarter w3-container w3-margin-bottom" style="width:100%">
            <div class="w3-container w3-white" id="heatmap">

            </div>

            <span id="operation"></span>
        </div>

        <h4 class="w3-container"><b>Operations</b></h4>
        <div class="w3-threequarter w3-container w3-margin-bottom" style="width:20%">
            <div class="w3-container w3-white" style="padding-right: 0">
                <p><b>Operation List</b></p>
                <div id="OperationList" class="contentDemo"></div>
            </div>
        </div>
        <div class="w3-quarter w3-container w3-margin-bottom" style="width:60%">
            <div class="w3-container w3-white">
                <p><b>Operations Overview</b></p>
                <div id="stats"></div>
            </div>
        </div>
        <div class="w3-quarter w3-container" style="width:20%">
            <div class="w3-container w3-white" style="padding-right: 0">
                <p><b>Commonly encountered</b></p>
                <div id="commonOp" class="contentDemo"></div>
            </div>
        </div>
    </div>

    <!--<div class="w3-black w3-center w3-padding-24" style="float: bottom">Malware Visualization</div>-->

    <!-- End page content -->
</div>
<div id="loading">
    <img id="loading-image" height="200" width="200" src="../images/squareloader2.gif" alt="Loading..."/>
</div>
<script>
    var calculateRank;
    var openSidebarRank, opensidebarLib;
    var sideWidth = 1000;

    function openNavRank() {
        if (!calculateRank) {
            calculateRank = 1;
        }
        document.getElementById("mySidenavRank").style.width = sideWidth + "px";
        // document.getElementById("mainContent").style.marginLeft = "1200px";
        openSidebarRank = !openSidebarRank;
    }

    function closeNavRank() {
        d3.select("mySidenavRank").classed("raise", false);
        document.getElementById("mySidenavRank").style.width = "0";
        // document.getElementById("mainContent").style.marginLeft= "0";
        openSidebarRank = !openSidebarRank;
    }

    function openNavLib() {
        document.getElementById("mySidenavLib").style.width = sideWidth + "px";
        // document.getElementById("mainContent").style.marginLeft = "1200px";
        opensidebarLib = !opensidebarLib;
    }

    function closeNavLib() {
        document.getElementById("mySidenavLib").style.width = "0";
        // document.getElementById("mainContent").style.marginLeft= "0";
        opensidebarLib = !opensidebarLib;
    }

    // Script to open and close sidebar
    function w3_open() {
        document.getElementById("mySidebar").style.display = "block";
        document.getElementById("myOverlay").style.display = "block";
    }

    function w3_close() {
        document.getElementById("mySidebar").style.display = "none";
        document.getElementById("myOverlay").style.display = "none";
    }
</script>
<script src="../js/v3ultility.js"></script>
<script src="../js/v3main.js"></script>
<script>
    let divOperation = d3.select("body").append("div")
        .attr("class", "tooltip")
        .style("opacity", 0);

    let div = d3.select("body").append("div")
        .attr("class", "tooltip")
        .style("opacity", 0);

    let div2 = d3.select("body").append("div")
        .attr("class", "tooltip2")
        .style("opacity", 0);

    let div3 = d3.select("body").append("div")
        .attr("class", "tooltip3")
        .style("opacity", 0);

    $('select#selectmalware').on('change', function (e) {
        let optionSelected = $("option:selected", this);
        let valueSelected = this.value;
        let loading = d3.select('body').append('div').attr('id', 'loading');
        loading.append('img')
            .attr('id', 'loading-image')
            .attr('src', 'images/squareloader2.svg')
            .attr("height", "200")
            .attr("height", "200");
        init(valueSelected);

    });
    let init = function (filePath) {
        d3.queue()
            .defer(d3.csv, "../data/" + filePath, function (d) {
                return {
                    Timestamp: d['Time of Day'],
                    PID: d['PID'],
                    Process_Name: d['Process Name'],
                    Operation: d["Operation"],
                    Path: d["Path"],
                    Detail: d["Detail"]
                }
            })
            .defer(d3.csv, "../data/domain.csv")
            // .defer(d3.csv, "metadata/infosec.csv")
            .await(function (error, original_data, domain) {
                if (error) {
                    console.error(error);
                }
                else {
                    let data = ProcessDataV2(original_data, domain);
                    let SiteManager = applicationManager(data); //Initialize application
                    SiteManager.drawStats('#stats'); //Draw statistic map
                    SiteManager.drawStats2('#OperationList'); //Draw statistic map
                    SiteManager.malist("#commonOp");
                    // d3.select("#rankBtn")
                    //     .on("click", () => {
                    //         if (calculateRank === 1){
                    //             SiteManager.highlight('#avaiop'); // hightlight
                    //             calculateRank = 2;
                    //         }
                    //     });
                    SiteManager.drawMain('#heatmap');//Draw mainMap
                    let maxcalls = SiteManager.getCallRange().maxcall;
                    SiteManager.connectedDomain('#maliciousdomain');

                    // for testing --------------------
                    openNavRank();
                    SiteManager.highlight('#avaiop');
                    // --------------------------------

                    $("#btnName").click(function () {
                            SiteManager.sort2DMatrix('similarity')
                        }
                    );
                    $("#btnNum").click(function () {
                            SiteManager.sort2DMatrix('numlinks')
                        }
                    );
                    $("#btnCount").click(function () {
                            SiteManager.sort2DMatrix('numcount')
                        }
                    );

                    $(function () {
                        let handle = $("#custom-handle");
                        $("#slider").slider({
                            min: 0,
                            value: 3,
                            max: maxcalls,
                            create: function () {
                                handle.text($(this).slider("value"));
                            },
                            slide: function (event, ui) {
                                $("#amount").val("Min: " + ui.value + " - Max: " + maxcalls);
                                handle.text(ui.value);
                                SiteManager.updateRangeFilter(ui.value, maxcalls)
                            }
                        });
                        $("#amount").val("Min: " + 3 + " - Max: " + maxcalls);
                    });

                    SiteManager.updateRangeFilter(3, maxcalls);
                    isready = true;
                }
            });
    };
    init("Huyen-Ransomware-WannaPeace.csv");

    var list = {
        "CloseFile": {"operation": "FileSystem", "index": 0},
        "CreateFile": {"operation": "FileSystem", "index": 1},
        "CreateFileMapping": {"operation": "FileSystem", "index": 2},
        "DeviceIoControl": {"operation": "FileSystem", "index": 3},
        "FileSystemControl": {"operation": "FileSystem", "index": 4},
        "FlushBuffersFile": {"operation": "FileSystem", "index": 5},
        "LockFile": {"operation": "FileSystem", "index": 6},
        "NotifyChangeDirectory": {"operation": "FileSystem", "index": 7},
        "QueryAllInformationFile": {"operation": "FileSystem", "index": 8},
        "QueryAttributeInformationVolume": {"operation": "FileSystem", "index": 9},
        "QueryAttributeTagFile": {"operation": "FileSystem", "index": 10},
        "QueryBasicInformationFile": {"operation": "FileSystem", "index": 11},
        "QueryDeviceRelations": {"operation": "FileSystem", "index": 12},
        "QueryDirectory": {"operation": "FileSystem", "index": 13},
        "QueryEAFile": {"operation": "FileSystem", "index": 14},
        "QueryEaInformationFile": {"operation": "FileSystem", "index": 15},
        "QueryFileInternalInformationFile": {"operation": "FileSystem", "index": 16},
        "QueryFullSizeInformationVolume": {"operation": "FileSystem", "index": 17},
        "QueryInformationVolume": {"operation": "FileSystem", "index": 18},
        "QueryNameInformationFile": {"operation": "FileSystem", "index": 19},
        "QueryNetworkOpenInformationFile": {"operation": "FileSystem", "index": 20},
        "QueryNormalizedNameInformationFile": {"operation": "FileSystem", "index": 21},
        "QueryObjectIdInformationVolume": {"operation": "FileSystem", "index": 22},
        "QueryOpen": {"operation": "FileSystem", "index": 23},
        "QueryPositionInformationFile": {"operation": "FileSystem", "index": 24},
        "QueryRemoteProtocolInformation": {"operation": "FileSystem", "index": 25},
        "QuerySecurityFile": {"operation": "FileSystem", "index": 26},
        "QuerySizeInformationVolume": {"operation": "FileSystem", "index": 27},
        "QueryStandardInformationFile": {"operation": "FileSystem", "index": 28},
        "QueryStreamInformationFile": {"operation": "FileSystem", "index": 29},
        "ReadFile": {"operation": "FileSystem", "index": 30},
        "SetAllocationInformationFile": {"operation": "FileSystem", "index": 31},
        "SetBasicInformationFile": {"operation": "FileSystem", "index": 32},
        "SetDispositionInformationFile": {"operation": "FileSystem", "index": 33},
        "SetEndOfFileInformationFile": {"operation": "FileSystem", "index": 34},
        "SetPositionInformationFile": {"operation": "FileSystem", "index": 35},
        "SetRenameInformationFile": {"operation": "FileSystem", "index": 36},
        "SetSecurityFile": {"operation": "FileSystem", "index": 37},
        "UnlockFileSingle": {"operation": "FileSystem", "index": 38},
        "WriteFile": {"operation": "FileSystem", "index": 39},
        "InternalDeviceIoControl": {"operation": "FileSystem", "index": 40},
        "System Statistics": {"operation": "FileSystem", "index": 41},
        "SystemControl": {"operation": "FileSystem", "index": 42},
        "Load Image": {"operation": "ProcessThread", "index": 0},
        "Process Create": {"operation": "ProcessThread", "index": 1},
        "Process Exit": {"operation": "ProcessThread", "index": 2},
        "Process Start": {"operation": "ProcessThread", "index": 3},
        "Thread Create": {"operation": "ProcessThread", "index": 4},
        "Thread Exit": {"operation": "ProcessThread", "index": 5},
        "RegCloseKey": {"operation": "Registry", "index": 0},
        "RegCreateKey": {"operation": "Registry", "index": 1},
        "RegDeleteKey": {"operation": "Registry", "index": 2},
        "RegDeleteValue": {"operation": "Registry", "index": 3},
        "RegEnumKey": {"operation": "Registry", "index": 4},
        "RegEnumValue": {"operation": "Registry", "index": 5},
        "RegFlushKey": {"operation": "Registry", "index": 6},
        "RegLoadKey": {"operation": "Registry", "index": 7},
        "RegOpenKey": {"operation": "Registry", "index": 8},
        "RegQueryKey": {"operation": "Registry", "index": 9},
        "RegQueryKeySecurity": {"operation": "Registry", "index": 10},
        "RegQueryMultipleValueKey": {"operation": "Registry", "index": 11},
        "RegQueryValue": {"operation": "Registry", "index": 12},
        "RegSetInfoKey": {"operation": "Registry", "index": 13},
        "RegSetKeySecurity": {"operation": "Registry", "index": 14},
        "RegSetValue": {"operation": "Registry", "index": 15},
        "TCP Accept": {"operation": "Network", "index": 0},
        "TCP Connect": {"operation": "Network", "index": 1},
        "TCP Disconnect": {"operation": "Network", "index": 2},
        "TCP Receive": {"operation": "Network", "index": 3},
        "TCP Reconnect": {"operation": "Network", "index": 4},
        "TCP Retransmit": {"operation": "Network", "index": 5},
        "TCP Send": {"operation": "Network", "index": 6},
        "TCP TCPCopy": {"operation": "Network", "index": 7},
        "UDP Receive": {"operation": "Network", "index": 8},
        "UDP Accept": {"operation": "Network", "index": 9},
        "UDP Connect": {"operation": "Network", "index": 10},
        "UDP Send": {"operation": "Network", "index": 11},
        "Process Profiling": {"operation": "Profiling", "index": 0},
        "Others": {"operation": "Others", "index": 0}
    };
    var colorScaleOrange = d3.scaleSequential(d3["interpolateYlOrBr"])// File: 0-38
        .domain([70, -30]);

    var colorScaleGreen = d3.scaleSequential(d3["interpolateGreens"]) // Registry: 0-14
        .domain([20, -3]);

    var colorScaleBlue = d3.scaleSequential(d3["interpolateBlues"])  // Process: 0-5
        .domain([8, -2]);

    var colorScaleRed = d3.scaleSequential(d3["interpolateReds"]) // Network: 0-9
        .domain([15, -5]);

    function getProcessName(operation) {
        if (!list[operation]) {
            return "Others"
        } else return list[operation]["operation"]
            ;
    }

    var sub = d3.keys(list);

    function colorPicker(operation) {
        if (list[operation]) {
            switch (list[operation]["operation"]) {
                case "FileSystem":
                    return colorScaleOrange(list[operation]["index"]);
                case "Registry":
                    return colorScaleGreen(list[operation]["index"]);
                case "Network":
                    return colorScaleRed(list[operation]["index"]);
                case "ProcessThread":
                    return colorScaleBlue(list[operation]["index"]);
                case "Profiling":
                    return "#6854b1";
                default:
                    return "#5d5d5d"
            }
        } else return "#5d5d5d"
    }
</script>
</body>
</html>
